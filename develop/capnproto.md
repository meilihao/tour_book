# capnproto
参考:
- [学习Cap'n proto](https://www.jianshu.com/p/f1110b22cb5c)

Cap'n Proto的编码是方案是独立于任何平台的，但在现在的CPU上面（小端序）会有更高的性能. 数据的组织类似compiler组织struct：固定宽度，固定偏移，以及合适的内存对齐，对于可变的数组使用pointer嵌入，而pointer也是使用的偏移存放而不是绝对地址. 整数使用的是小端序，因为多数现代CPU都是小端序的.

[example](https://capnproto.org/language.html)
```conf
@0xdbb9ad1f14bf0b36;  # unique file ID, generated by `capnp id`

struct Person {
  name @0 :Text;
  birthdate @3 :Date;

  email @1 :Text;
  phones @2 :List(PhoneNumber);

  struct PhoneNumber {
    number @0 :Text;
    type @1 :Type;

    enum Type {
      mobile @0;
      home @1;
      work @2;
    }
  }
}

struct Date {
  year @0 :Int16;
  month @1 :UInt8;
  day @2 :UInt8;
}
```
> 使用 #进行注释，注释应该跟在定义的后面，或者新启一行


要点:
- 类型在名字之后

    到目前为止，名字是最重要的东西，尤其是在快速浏览时，所以把它放在前面最显眼的地方. 这点跟c语言是反的，它是先类型，在变量名，不过很多现代的新语言，譬如go，rust等都是先名字，再类型了

- @N注解显示了协议是如何随着时间的推移而演变的，这样系统就可以确保与旧版本保持兼容.

    字段（和枚举式，以及接口方法）必须按照它们被添加的顺序从零开始**连续**编号. 在这个例子中，看起来birthdate字段是最近添加到Person结构中的--它的编号比电子邮件和电话字段高. 与Protobufs不同的是，在定义字段时，不能跳过序号.

## 内置类型

- Void: Void
- Boolean: Bool
- Integers: Int8, Int16, Int32, Int64
- Unsigned integers: UInt8, UInt16, UInt32, UInt64
- Floating-point: Float32, Float64
- Blobs: Text, Data
- Lists: List(T)

要点:
- Void : 一个可能的值, 不占空间. 很少使用, 但可作为union成员
- Text : utf-8编码, 以`\0`结尾
- Data : 任意的byte序列