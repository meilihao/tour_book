# chattr

chattr是针对某一类用户设置的, 针对某个指定用户可用acl.

## 描述

修改文件的扩展属性. 与chmod相比, chmod只能改变文件rwx权限, 更底层的属性是由chattr来修改的.

## 格式

    chattr [ options ] [ mode ] files...

## 选项
- i : 无法对文件进行修改；若对目录设置了该参数，则仅能修改其中的子文件内容而不能新建或删除文件
- a : 仅允许补充（追加）内容，无法覆盖/删除内容（Append Only）
- S : 文件内容在变更后立即同步到硬盘（sync）
- s : 彻底从硬盘中删除，不可恢复（用 0 填充原文件所在硬盘区域）
- A : 不再修改这个文件或目录的最后访问时间（atime）
- b : 不再修改文件或目录的存取时间
- D : 检查压缩文件中的错误
- d : 使用 dump 命令备份时忽略本文件/目录
- c : 默认将文件或目录进行压缩
- u : 当删除该文件后依然保留其在硬盘中的数据，方便日后恢复
- t : 让文件系统支持尾部合并（tail-merging）
- X : 可以直接访问压缩文件中的内容
- -R : 递归修改
- -V : 显示命令的执行过程

mode:
- + : 增加参数
- - : 移除参数
- = : 更新为指定参数
- A : 不修改该文件的atime
- a : 只能向文件追加内容, 而不能删除. 多用于保障日志文件的安全, 比如`.bash_history`
- i : 设定文件不能被删除, 改名, 写入或新增内容, 比如`/etc/passwd`

## 例
```bash
# lsattr ad.js # 查看文件的扩展属性
--------------e---- ad.js
# chattr +a ad.js # 追加属性`a`
# lsattr ad.js
-----a--------e---- ad.js
# rm -f ad.js 
rm: 无法删除'ad.js': 不允许的操作
# echo 111 >> ad.js # 能追加
# echo 222 > ad.js # 不能清空
bash: ad.js: 不允许的操作
# chattr +i ad.js
# rm ad.js # 即使root也不能删除
rm: 无法删除'ad.js': 不允许的操作
```
